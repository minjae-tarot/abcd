<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body {
    font-family: Arial, sans-serif;
    background: gray;
    color: white;
    text-align: center;
    padding: 20px;
    margin: 0;
  }

  h1 { margin-bottom: 10px; }

  button {
    width: 60px;
    height: 60px;
    font-size: 12px;
    margin: 20px;
    border: none;
    border-radius: 50%;
    cursor: pointer;
    background: gold;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 6px rgba(0,0,0,0.3);
    transition: transform 0.2s ease;
  }

  button:hover { transform: scale(1.1); }

  #deck {
    display: grid;
    grid-template-columns: repeat(13, 1fr);
    grid-gap: 10px;
    justify-content: center;
    max-width: 1000px;
    margin: 20px auto;
  }

  .card {
    width: 100%;
    aspect-ratio: 2 / 3;
    cursor: pointer;
    object-fit: cover;
    transition: transform 0.15s ease;
  }

  .card:hover { transform: scale(1.1); z-index: 10; }

  #resultArea {
    display: none;
    justify-content: center;
    align-items: center;
    gap: 30px;
    margin-top: 50px;
    padding: 20px;
  }

  .result-card-container {
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .result-card {
    width: 150px;
    height: auto;
    box-shadow: 0 10px 20px rgba(0,0,0,0.5);
  }

  .card-label {
    margin-top: 15px;
    font-weight: bold;
  }
 @media (max-width: 720px) {

    html, body {
      height: 100vh;
      overflow: hidden;
      margin: 0;
      padding: 0;
    }

    body {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    button#shuffleBtn {
      width: 40px;
      height: 40px;
      margin: 20px 0;
    }

    #deck { 
      display: grid;
      grid-template-columns: repeat(9, 1fr);
      grid-gap: 3px;
      padding: 5px;
      width: 100%;
      height: calc(100vh - 60px);
      box-sizing: border-box;
      align-content: start;
    }

    .card {
      width: 100%;
      aspect-ratio: 2 / 3;
      object-fit: contain;
      border-radius: 3px;
      border: 1px solid rgba(255,255,255,0.2);
    }

    #resultArea { 
      display: none; 
      gap: 10px;
      padding: 10px;
      align-items: center;
      justify-content: center;
    }

    .result-card-container { width: 30%; }
    .result-card { width: 100%; height: auto; }
  }
 
</style>
</head>
<body>

<button id="shuffleBtn" onclick="shuffleDeck()"></button>

<div id="deck"></div>

<div id="resultArea">
  <div class="result-card-container">
    <img id="pos1" class="result-card">
  </div>
  <div class="result-card-container">
    <img id="pos2" class="result-card">
  </div>
  <div class="result-card-container">
    <img id="pos3" class="result-card">
  </div>
</div>

<script>
  const deckDiv = document.getElementById("deck");
  const resultArea = document.getElementById("resultArea");
  const shuffleBtn = document.getElementById("shuffleBtn");

  const backImage = "https://minjae-tarot.github.io/abcd/cards/joker.png";
  const baseURL = "https://minjae-tarot.github.io/abcd/cards/img(";
  const ext = ").jpg";
  
  let deckOrder = [];
  let selectedCards = [];
  const maxSelect = 3;

  function initDeck(){
    deckOrder = [];
    for(let i=1; i<=78; i++){
      deckOrder.push(i);
    }
  }

  function renderDeck(){
    deckDiv.innerHTML = "";
    selectedCards = [];
    resultArea.style.display = "none";
    deckDiv.style.display = "grid"; 

    deckOrder.forEach(num => {
      const img = document.createElement("img");
      img.className = "card";
      img.src = backImage;
      img.dataset.num = num;
      img.addEventListener("click", () => selectCard(img));
      deckDiv.appendChild(img);
    });
  }

  function selectCard(img){
    if(selectedCards.length >= maxSelect) return;
    const num = img.dataset.num;
    if(selectedCards.includes(num)) return;

    selectedCards.push(num);
    img.style.visibility = "hidden";

    if(selectedCards.length === maxSelect){
      showResult();
    }
  }

  function showResult(){
    const posIds = ["pos1", "pos2", "pos3"];
    for(let i=0; i < maxSelect; i++){
      const cardImg = document.getElementById(posIds[i]);
      cardImg.src = baseURL + selectedCards[i] + ext;
    }
    
    deckDiv.style.display = "none"; 
    resultArea.style.display = "flex";
    shuffleBtn.style.display = "inline-flex"; 
    
    resultArea.scrollIntoView({behavior:"smooth"});
  }

  function resetResult(){
    const posIds = ["pos1", "pos2", "pos3"];
    posIds.forEach(id => {
      document.getElementById(id).src = "";
    });
    resultArea.style.display = "none";
  }

  function shuffleDeck(){
    shuffleBtn.style.display = "none"; 
    resetResult(); 
    for(let i=deckOrder.length -1; i>0; i--){
      const j = Math.floor(Math.random()*(i+1));
      [deckOrder[i], deckOrder[j]] = [deckOrder[j], deckOrder[i]];
    }
    renderDeck();
  }

  initDeck();
</script>

</body>
</html>
